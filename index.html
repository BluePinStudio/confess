<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Confess</title>

<!-- Google Font -->
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

<style>
    *, *::before, *::after {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
    }

    html, body {
        width: 100%;
        height: 100%;
        font-family: 'Poppins', sans-serif;
        background: linear-gradient(135deg, #1E1E2F 0%, #3B185F 50%, #AC255E 100%);
        display: flex;
        flex-direction: column;
        align-items: center;
        color: #fff;
        overflow: hidden;
    }

    .title-bar {
        margin-top: 2rem;
        margin-bottom: 1rem;
        text-align: center;
        animation: fadeInDown 1s ease;
    }

    .title-bar h1 {
        font-size: 2rem;
        font-weight: 600;
        text-shadow: 0 0 10px #fff, 0 0 20px #fff;
    }

    @keyframes fadeInDown {
        from { opacity: 0; transform: translateY(-20px); }
        to { opacity: 1; transform: translateY(0); }
    }

    .container {
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        border-radius: 20px;
        padding: 2rem;
        width: 90%;
        max-width: 400px;
        display: flex;
        flex-direction: column;
        gap: 1.5rem;
        box-shadow: 0 0 30px rgba(0,0,0,0.2);
        border: 1px solid rgba(255,255,255,0.2);
        animation: fadeIn 1s ease;
    }

    @keyframes fadeIn {
      from {opacity: 0; transform: scale(0.95);}
      to {opacity: 1; transform: scale(1);}
    }

    .container h2 {
        font-weight: 600;
        font-size: 1.8rem;
        text-align: center;
        text-shadow: 0 0 10px #fff, 0 0 20px #fff, 0 0 30px #AC255E, 0 0 40px #AC255E;
        animation: glow 2s infinite alternate ease-in-out;
        margin-bottom: 0.5rem;
    }

    @keyframes glow {
      0% {text-shadow: 0 0 10px #AC255E;}
      100% {text-shadow: 0 0 20px #AC255E, 0 0 40px #AC255E;}
    }

    #messageInput {
        width: 100%;
        padding: 0.75rem 1rem;
        border: none;
        border-radius: 8px;
        font-size: 1rem;
        color: #fff;
        background: rgba(255,255,255,0.2);
        outline: none;
        height: 100px;
        resize: none;
        line-height: 1.4;
        overflow-wrap: break-word;
        transition: box-shadow 0.3s ease;
    }

    #messageInput::placeholder {
        color: #ccc;
    }

    #messageInput:focus {
        box-shadow: 0 0 10px #AC255E, 0 0 20px #AC255E;
    }

    #submitBtn {
        padding: 0.75rem 1rem;
        font-size: 1rem;
        color: #fff;
        background: linear-gradient(45deg, #AC255E, #3B185F);
        border: none;
        border-radius: 8px;
        cursor: pointer;
        position: relative;
        overflow: hidden;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    #submitBtn:hover {
        transform: translateY(-2px) scale(1.02);
        box-shadow: 0 5px 15px rgba(172,37,94,0.5);
    }

    #submitBtn:active {
        transform: scale(0.98);
    }

    #submitBtn::before {
        content: "";
        position: absolute;
        top: 0; left: 0;
        width: 0; height: 0;
        background: rgba(255,255,255,0.3);
        border-radius: 50%;
        transform: translate(-50%, -50%);
        pointer-events: none;
        opacity: 0;
        transition: width 0.3s ease, height 0.3s ease, opacity 0.3s ease;
    }

    #submitBtn:hover::before {
        width: 200%; 
        height: 200%; 
        opacity: 0.1; 
    }

    #feedback {
        font-size: 0.9rem;
        text-align: center;
        min-height: 1.5em;
        letter-spacing: 0.5px;
        transition: color 0.3s ease;
    }

    .linktree {
        display: flex;
        justify-content: center;
        gap: 1rem;
        flex-wrap: wrap;
        margin-top: 1rem;
    }

    .linktree a {
        display: flex;
        align-items: center;
        justify-content: center;
        background: rgba(255,255,255,0.2);
        padding: 0.5rem;
        border-radius: 20px;
        transition: background 0.3s ease;
        width: 40px; height: 40px;
    }

    .linktree a:hover {
        background: rgba(255,255,255,0.4);
    }

    .linktree img {
        width: 24px;
        height: 24px;
    }

    @media (max-width: 480px) {
        .container h2 {
            font-size: 1.4rem;
        }
        #messageInput, #submitBtn {
            font-size: 0.9rem;
        }
    }
</style>
</head>
<body>

<div class="title-bar">
    <h1>Confess</h1>
</div>

<div class="container">
    <h2>Submit Your Message</h2>
    <textarea id="messageInput" placeholder="Enter text (10-250 chars). Press Enter to submit." wrap="soft"></textarea>
    <div id="feedback"></div>
    <button id="submitBtn">Submit</button>

    <div class="linktree">
        <a href="https://twitter.com/yourprofile" target="_blank">
            <img src="https://via.placeholder.com/24x24?text=T" alt="Twitter">
        </a>
        <a href="https://instagram.com/yourprofile" target="_blank">
            <img src="https://via.placeholder.com/24x24?text=I" alt="Instagram">
        </a>
        <a href="https://facebook.com/yourprofile" target="_blank">
            <img src="https://via.placeholder.com/24x24?text=F" alt="Facebook">
        </a>
        <a href="https://bsky.app/profile/yourprofile" target="_blank">
            <img src="https://via.placeholder.com/24x24?text=B" alt="Bluesky">
        </a>
    </div>
</div>

<script>
    const messageInput = document.getElementById('messageInput');
    const submitBtn = document.getElementById('submitBtn');
    const feedback = document.getElementById('feedback');

    const endpointURL = "https://script.google.com/macros/s/AKfycbzVr60PRxArRoWn7GzhLShBvDNHnrQ4i6w9aZNHQJQQgX0Vrtpr8SumMyFGDWmyczfpvQ/exec";
    const cooldownTime = 10000; // 10 seconds
    let isCoolingDown = false;

    function handleResponse(data) {
        submitBtn.disabled = false;
        messageInput.disabled = false;
        feedback.style.color = '#00FFAA';
        feedback.textContent = "Message submitted successfully!";
        
        // Clear the textarea
        messageInput.value = '';
        
        startCooldown();
    }

    function submitMessage() {
        if (isCoolingDown) {
            feedback.style.color = 'red';
            feedback.textContent = "Please wait before submitting again.";
            return;
        }

        const userText = messageInput.value.trim();

        if (userText.length < 10) {
            feedback.style.color = 'red';
            feedback.textContent = "Your entry is too short! Min 10 chars.";
            return;
        }

        if (userText.length > 250) {
            feedback.style.color = 'red';
            feedback.textContent = "Your entry is too long! Max 250 chars.";
            return;
        }

        feedback.style.color = '#fff';
        feedback.textContent = "Submitting...";
        submitBtn.disabled = true;
        messageInput.disabled = true;

        // Determine simplified device string
        const device = getDeviceType();

        // Create a script tag for JSONP
        const script = document.createElement('script');
        script.src = endpointURL + "?callback=handleResponse&text=" + encodeURIComponent(userText) + "&device=" + encodeURIComponent(device);
        document.body.appendChild(script);
    }

    function startCooldown() {
        isCoolingDown = true;
        submitBtn.disabled = true;
        messageInput.disabled = true;
        setTimeout(() => {
            isCoolingDown = false;
            submitBtn.disabled = false;
            messageInput.disabled = false;
            feedback.textContent = "";
        }, cooldownTime);
    }

    // Prevent newlines: On keydown 'Enter' submits the message, no shift enter allowed
    messageInput.addEventListener('keydown', function(e) {
        if (e.key === 'Enter') {
            e.preventDefault();
            submitMessage();
        }
    });

    // Prevent pasting newlines:
    messageInput.addEventListener('paste', function(e) {
        e.preventDefault();
        let pastedText = (e.clipboardData || window.clipboardData).getData('text');
        pastedText = pastedText.replace(/\r?\n|\r/g, ' '); // Replace newlines with space
        document.execCommand('insertText', false, pastedText);
    });

    submitBtn.addEventListener('click', submitMessage);

    function getDeviceType() {
        const ua = navigator.userAgent.toLowerCase();
        if (/android/.test(ua)) return "Android";
        if (/iphone|ipad|ipod/.test(ua)) return "iOS";
        if (/windows/.test(ua)) return "Windows";
        if (/macintosh|mac os x/.test(ua)) return "macOS";
        return "Other";
    }
</script>
</body>
</html>
